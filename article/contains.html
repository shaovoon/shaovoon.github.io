<html>
<head>
  <title>Do not use std::unordered_map contains()</title>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body id="outer">
<div id="inner">
<div class="outer_obj"><h1>Do not use std::unordered_map contains()</h1></div>

<p><em>Posted on 2022-06-11</em></p>

<p><strong>Public Service Announcement</strong>: Do not use std::unordered_map’s <a href="https://en.cppreference.com/w/cpp/container/unordered_map/contains" target="_blank">contains()</a> from performance POV. If you use contains() or <a href="https://en.cppreference.com/w/cpp/container/unordered_map/count" target="_blank">count()</a> to check a key exists and then find the value for further processing, you incur the cost of double lookups!</p>

<p><img src="contains.png" alt="" width="353" height="146"></p>

<p>The solution is to use try_get(). It is a shame that std::unordered_map does not have try_get() while it has <a href="https://en.cppreference.com/w/cpp/container/unordered_map/try_emplace" target="_blank">try_emplace()</a> since C++17. Even .NET Dictionary class has <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.dictionary-2.trygetvalue?view=net-6.0" target="_blank">TryGetValue()</a>. Fortunately, it is not difficult to implement try_get() as a free function using std::unordered_map’s <a href="https://en.cppreference.com/w/cpp/container/unordered_map/find" target="_blank">find()</a>.</p>

<p><img src="try_get.png" alt="" width="578" height="383"></p>

</div>

</body>
</html>